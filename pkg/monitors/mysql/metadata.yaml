monitors:
- monitorType: mysql
  doc: |
    This monitor pulls metrics from all PostgreSQL databases from a specific
    Postgres server instance.  It pulls basic information that is applicable
    to any database. It gathers these metrics via SQL queries.

    If you want to collect additional metrics about Mysql, use the [sql monitor](./sql.md).

    <!--- SETUP --->
    ## Example Configuration

    This example uses the [Vault remote config
    source](https://github.com/signalfx/signalfx-agent/blob/master/docs/remote-config.md#nested-values-vault-only)
    to connect to PostgreSQL using the `params` map that allows you to pull
    out the username and password individually from Vault and interpolate
    them into the `connectionString` config option.

    ```yaml
    monitors:
     - type: mysql
       connectionString: 'sslmode=disable user={{.username}} password={{.password}}'
       params: &psqlParams
         username: {"#from": "vault:secret/my-database[username]"}
         password: {"#from": "vault:secret/my-database[password]"}
       discoveryRule: 'container_image =~ "postgres" && port == 5432'

     # This monitor will monitor additional queries from PostgreSQL using the
     # provided SQL queries.
     - type: sql
       dbDriver: postgres
       connectionString: 'sslmode=disable user={{.username}} password={{.password}}'
       # This is a YAML reference to avoid duplicating the above config.
       params: *psqlParams
       queries:
         - query: 'SELECT COUNT(*) as count, country, status FROM customers GROUP BY country, status;'
           metrics:
             - metricName: "customers"
               valueColumn: "count"
               dimensionColumns: ["country", "status"]
    ```

  dimensions:
    type:
      description: Whether the object (table, index, function, etc.) belongs to the
        `system` or `user`.
  metrics:
    postgres_database_size:
      description: Size in bytes of the database on disk
      default: true
      type: gauge